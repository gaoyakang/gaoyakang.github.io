
<!DOCTYPE html>
<html lang="en" class="loading">
<head><meta name="generator" content="Hexo 3.9.0">
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Jest测试入门到深入 - GYK</title>
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="google" content="notranslate">
    <meta name="keywords" content="node,"> 
    <meta name="description" content="Lonely&#39;s blog,BOTTOM

前端测试
前端测试作为前端工程化的一部分，对于写出高质量的代码，便于后期维护扩展有重要的作用，本文就对前端测试做详细的说明。

1.术语解析前端的测试基本是在单元测试和端到端测试的测,"> 
    <meta name="author" content="kk"> 
    <link rel="alternative" href="atom.xml" title="GYK" type="application/atom+xml"> 
    
    <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.css">
    <link rel="stylesheet" href="/css/diaspora.css">
    <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
    <script>
         (adsbygoogle = window.adsbygoogle || []).push({
              google_ad_client: "ca-pub-8691406134231910",
              enable_page_level_ads: true
         });
    </script>
    <script async custom-element="amp-auto-ads" src="https://cdn.ampproject.org/v0/amp-auto-ads-0.1.js">
    </script>
</head>
</html>
<body class="loading">
    <span id="config-title" style="display:none">GYK</span>
    <div id="loader"></div>
    <div id="single">
    <div id="top" style="display: block;">
    <div class="bar" style="width: 0;"></div>
    <a class="icon-home image-icon" href="javascript:;" data-url="https://gaoyakang.github.io"></a>
    <div title="播放/暂停" class="icon-play"></div>
    <h3 class="subtitle">Jest测试入门到深入</h3>
    <div class="social">
        <!--<div class="like-icon">-->
            <!--<a href="javascript:;" class="likeThis active"><span class="icon-like"></span><span class="count">76</span></a>-->
        <!--</div>-->
        <div>
            <div class="share">
                <a title="获取二维码" class="icon-scan" href="javascript:;"></a>
            </div>
            <div id="qr"></div>
        </div>
    </div>
    <div class="scrollbar"></div>
</div>

    <div class="section">
        <div class="article">
    <div class='main'>
        <h1 class="title">Jest测试入门到深入</h1>
        <div class="stuff">
            <span>一月 17, 2019</span>
            

        </div>
        <div class="content markdown">
            <div style="text-align:center;margin:30px;font-size:20px;border-radius:5px;border:3px solid #eee; cursor:pointer;" onclick="javascript:window.scrollTo(0, document.body.clientHeight)">BOTTOM</div>

<h1 id="前端测试"><a href="#前端测试" class="headerlink" title="前端测试"></a>前端测试</h1><blockquote>
<p>前端测试作为前端工程化的一部分，对于写出高质量的代码，便于后期维护扩展有重要的作用，本文就对前端测试做详细的说明。</p>
</blockquote>
<h2 id="1-术语解析"><a href="#1-术语解析" class="headerlink" title="1.术语解析"></a>1.术语解析</h2><p><code>前端的测试基本是在单元测试和端到端测试的测试范围内，其中：</code></p>
<ul>
<li><code>单元测试是对单一模块的测试</code></li>
<li><code>端到端测试是对整体应用的所有模块进行测试</code></li>
<li><code>集成测试是对复合模块的测试</code></li>
</ul>
<p><code>此外，谈到前端测试我们还经常会听到TDD和BDD，它们只是不同的开发行为方式，其中：</code></p>
<ul>
<li><code>TDD是指test driven development,测试驱动开发，在实际开发时是先写测试用例后写业务代码</code></li>
<li><code>BDD是指behavior driven development,行为驱动开发，在实际开发时是先写业务代码然后根据用户行为写测试用例</code></li>
</ul>
<p><code>在写前端的代码测试时，通常可以自己写测试的方法和函数来实现，但这样太过于麻烦，已经有很多优秀的测试框架供我们使用，本文采用的技术栈是vue，于是测试框架就使用官方推荐的jest来实现单元测试和集成测试，版本为最新版本24.9</code></p>
<h2 id="2-JEST基础"><a href="#2-JEST基础" class="headerlink" title="2.JEST基础"></a>2.JEST基础</h2><h3 id="2-1-JEST安装使用"><a href="#2-1-JEST安装使用" class="headerlink" title="2.1 JEST安装使用"></a>2.1 JEST安装使用</h3><p><code>首先来安装</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">npm init -y</span><br><span class="line">npm install jest -D</span><br></pre></td></tr></table></figure>

<p><code>接着来新建业务代码文件和测试文件</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">touch demo.js</span><br><span class="line">touch demo.test.js</span><br></pre></td></tr></table></figure>

<p><code>修改脚本命令</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">//package.json</span><br><span class="line">&#123;</span><br><span class="line">  &quot;script&quot;:&#123;</span><br><span class="line">    &quot;test&quot;: &quot;jest --watchAll&quot;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>随便编写一些业务代码和测试代码</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">//demo.js</span><br><span class="line">function add (a, b) &#123;</span><br><span class="line">  return a + b;</span><br><span class="line">&#125;</span><br><span class="line">try &#123;</span><br><span class="line">  module.exports = &#123;</span><br><span class="line">    add</span><br><span class="line">  &#125;</span><br><span class="line">&#125;catch(e)&#123;&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">//demo.test.js</span><br><span class="line">import &#123; add &#125; from &apos;./demo.js&apos;</span><br><span class="line">test(&apos;add 函数测试&apos;, () =&gt; &#123;</span><br><span class="line">  expect(add(1,2)).toBe(3)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p><code>最后运行命令，jest会自动寻找test的文件并运行</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm run test</span><br></pre></td></tr></table></figure>

<p><code>就可以看到以下的结果：</code><br><img src="http://m.qpic.cn/psb?/V11lyZSe37bh9p/j5xb2y9*Dm3D7*Wo7UkR4mIn0GX6TaNLtAStYIsmuY8!/b/dLYAAAAAAAAA&bo=UwJ4AQAAAAADFxo!&rf=viewer_4&t=5" alt="test"><br><code>至此完成了下载使用</code></p>
<h3 id="2-2-JEST配置"><a href="#2-2-JEST配置" class="headerlink" title="2.2 JEST配置"></a>2.2 JEST配置</h3><p><code>前面已经完成了jest下载和使用，接下来看看jest的配置选项，不过默认的jest是zero config，提供开箱即用的体验，不过有时候我们还是需要配置一些个性化的选项来完成任务，开启jest的配置按照以下命令：</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npx jest --init</span><br></pre></td></tr></table></figure>

<p><code>如下图所示：</code><br><img src="http://m.qpic.cn/psb?/V11lyZSe37bh9p/kzGN2n8imbOXM75xe6*4gyp8ua0XewSJzWXd0m36gVw!/b/dL8AAAAAAAAA&bo=UwJ4AQAAAAADFxo!&rf=viewer_4&t=5" alt="config"></p>
<p><code>在目录下就有了一个jest.config.js的配置文件，里面有很多的默认配置，具体意义如下：</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br></pre></td><td class="code"><pre><span class="line">// 所有引入的模块都被自动模拟（即所有的模块都是你自己改写的模块而不是实际的模块）</span><br><span class="line">  // automock: false,</span><br><span class="line">// 默认直接把所有错误打印在控制台，设置bail可以规定jest在第几个错误后结束运行</span><br><span class="line">  // bail: 0,</span><br><span class="line">// 解析模块的时候是否采用package.json的Browserify中的browser字段</span><br><span class="line">  // browser: false,</span><br><span class="line">//Jest用来储存依赖信息缓存的目录</span><br><span class="line">  // cacheDirectory: &quot;&quot;,</span><br><span class="line">// 清除模拟实现</span><br><span class="line">  // clearMocks: false,</span><br><span class="line">// 是否收集测试时的覆盖率信息</span><br><span class="line">  // collectCoverage: false,</span><br><span class="line">// 需要收集测试覆盖率信息的目录，是一个数组</span><br><span class="line">  // collectCoverageFrom: null,</span><br><span class="line">// 生成的测试覆盖率报告的存放目录</span><br><span class="line">  // coverageDirectory: null,</span><br><span class="line">// 不需要进行覆盖率测试的目录</span><br><span class="line">  // coveragePathIgnorePatterns: [</span><br><span class="line">  //   &quot;\\\\node_modules\\\\&quot;</span><br><span class="line">  // ],</span><br><span class="line">// 覆盖率报告格式</span><br><span class="line">  // coverageReporters: [</span><br><span class="line">  //   &quot;json&quot;,</span><br><span class="line">  //   &quot;text&quot;,</span><br><span class="line">  //   &quot;lcov&quot;,</span><br><span class="line">  //   &quot;clover&quot;</span><br><span class="line">  // ],</span><br><span class="line">// 为覆盖率结果配置最小阈值，可以gloabal也可某个具体的文件路径，没有达到阈值时测试失败</span><br><span class="line">  // coverageThreshold: null,</span><br><span class="line">  // dependencyExtractor: null,</span><br><span class="line">  // errorOnDeprecated: false,</span><br><span class="line">// 强制执行覆盖率测试的文件</span><br><span class="line">  // forceCoverageMatch: [],</span><br><span class="line">  // globalSetup: null,</span><br><span class="line">  // globalTeardown: null,</span><br><span class="line">// 全局变量，在所有测试环境下都可以访问</span><br><span class="line">  // globals: &#123;&#125;,</span><br><span class="line">// 设定运行测试的最大工作池数目</span><br><span class="line">  // maxWorkers: &quot;50%&quot;,</span><br><span class="line">//  依赖模块的目录</span><br><span class="line">  // moduleDirectories: [</span><br><span class="line">  //   &quot;node_modules&quot;</span><br><span class="line">  // ],</span><br><span class="line">// 以下格式的文件引用时不需要加后缀</span><br><span class="line">  // moduleFileExtensions: [</span><br><span class="line">  //   &quot;js&quot;,</span><br><span class="line">  //   &quot;json&quot;,</span><br><span class="line">  //   &quot;jsx&quot;,</span><br><span class="line">  //   &quot;ts&quot;,</span><br><span class="line">  //   &quot;tsx&quot;,</span><br><span class="line">  //   &quot;node&quot;</span><br><span class="line">  // ],</span><br><span class="line">// 模块别名映射</span><br><span class="line">  // moduleNameMapper: &#123;&#125;,</span><br><span class="line">  // modulePathIgnorePatterns: [],</span><br><span class="line">  // notify: false,</span><br><span class="line">  // notifyMode: &quot;failure-change&quot;,</span><br><span class="line">  // preset: null,</span><br><span class="line">  // projects: null,</span><br><span class="line">  // reporters: undefined,</span><br><span class="line">// 重置mocks</span><br><span class="line">  // resetMocks: false,</span><br><span class="line">  // resetModules: false,</span><br><span class="line">  // resolver: null,</span><br><span class="line">  // restoreMocks: false,</span><br><span class="line"></span><br><span class="line">  // rootDir: null,</span><br><span class="line">  // roots: [</span><br><span class="line">  //   &quot;&lt;rootDir&gt;&quot;</span><br><span class="line">  // ],</span><br><span class="line">  // runner: &quot;jest-runner&quot;,</span><br><span class="line">  // setupFiles: [],</span><br><span class="line">  // setupFilesAfterEnv: [],</span><br><span class="line">// 快照代码格式化</span><br><span class="line">  // snapshotSerializers: [],</span><br><span class="line">  testEnvironment: &quot;node&quot;,</span><br><span class="line">  // testEnvironmentOptions: &#123;&#125;,</span><br><span class="line">  // testLocationInResults: false,</span><br><span class="line">  // testMatch: [</span><br><span class="line">  //   &quot;**/__tests__/**/*.[jt]s?(x)&quot;,</span><br><span class="line">  //   &quot;**/?(*.)+(spec|test).[tj]s?(x)&quot;</span><br><span class="line">  // ],</span><br><span class="line">// 不用测试的文件</span><br><span class="line">  // testPathIgnorePatterns: [</span><br><span class="line">  //   &quot;\\\\node_modules\\\\&quot;</span><br><span class="line">  // ],</span><br><span class="line">  // testRegex: [],</span><br><span class="line">  // testResultsProcessor: null,</span><br><span class="line">  // testRunner: &quot;jasmine2&quot;,</span><br><span class="line">  // testURL: &quot;http://localhost&quot;,</span><br><span class="line">  // timers: &quot;real&quot;,</span><br><span class="line">  // transform: null,</span><br><span class="line">  // transformIgnorePatterns: [</span><br><span class="line">  //   &quot;\\\\node_modules\\\\&quot;</span><br><span class="line">  // ],</span><br><span class="line">  // unmockedModulePathPatterns: undefined,</span><br><span class="line">  // verbose: null,</span><br><span class="line">  // watchPathIgnorePatterns: [],</span><br><span class="line">  // watchman: true,</span><br></pre></td></tr></table></figure>

<p><code>此时我们的代码使用的是commonjs的模块规范，但前端代码是跑在浏览器上的，所以需要使用ES6模块规范，具体配置如下：</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i @babel/core @babel/preset-env -D</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">//.babelrc</span><br><span class="line">&#123;</span><br><span class="line">  &quot;presets&quot;: [</span><br><span class="line">  	[&quot;@babel/preset-env&quot;,&#123;</span><br><span class="line">  	  &quot;targets&quot;: &#123;</span><br><span class="line">  	    &quot;node&quot;: &quot;current&quot;</span><br><span class="line">  	  &#125;</span><br><span class="line">  	&#125;]</span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>将commonjs模块规范改成ES模块规范，然后直接运行命令</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm run test</span><br></pre></td></tr></table></figure>

<p><code>同样可以正常运行</code></p>
<p><img src="http://m.qpic.cn/psb?/V11lyZSe37bh9p/ritpbfEMIOSYjyxI6Y*0N0dspRG5NWp1PLRRi..p*8U!/b/dDUBAAAAAAAA&bo=UwJ4AQAAAAADFxo!&rf=viewer_4&t=5" alt="res"></p>
<h3 id="2-3-JEST匹配器"><a href="#2-3-JEST匹配器" class="headerlink" title="2.3 JEST匹配器"></a>2.3 JEST匹配器</h3><p><code>jest中的断言中有很多的匹配器，具体的意义如下：</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">test(&apos;匹配器&apos;, () =&gt; &#123;</span><br><span class="line">  // 跟踪所有失败的匹配器</span><br><span class="line">  expect().toBe()</span><br><span class="line">  // 递归检查对象或数组的每个字段</span><br><span class="line">  expect().toEqual()</span><br><span class="line">  // 只匹配 null</span><br><span class="line">  expect(n).toBeNull();</span><br><span class="line">  // 只匹配 undefined</span><br><span class="line">  expect(n).not.toBeUndefined();</span><br><span class="line">  // 匹配任何 if 语句为真</span><br><span class="line">  expect(n).not.toBeTruthy();</span><br><span class="line">  // 匹配任何 if 语句为假</span><br><span class="line">  expect(n).toBeFalsy();</span><br><span class="line">  // 比较浮点数相等</span><br><span class="line">  expect(value).toBeCloseTo(0.3)</span><br><span class="line">  // 字符串</span><br><span class="line">  expect(&apos;Christoph&apos;).toMatch(/stop/);</span><br><span class="line">  // 检查一个数组或可迭代对象</span><br><span class="line">  expect(shoppingList).toContain(&apos;beer&apos;);</span><br><span class="line">  // 特定函数抛出一个错误</span><br><span class="line">  expect(compileAndroidCode).toThrow();</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h3 id="2-4-JEST测试异步代码"><a href="#2-4-JEST测试异步代码" class="headerlink" title="2.4 JEST测试异步代码"></a>2.4 JEST测试异步代码</h3><p><code>在jest中测试异步代码时，如果不加以处理，jest默认是不会执行异步代码的，所以必须要加以处理</code></p>
<h3 id="2-4-1回调形式的异步代码"><a href="#2-4-1回调形式的异步代码" class="headerlink" title="2.4.1回调形式的异步代码"></a>2.4.1回调形式的异步代码</h3><p><code>如果异步代码是以回调的方式来实现，那在测试时使用以下方法</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">//demo.js</span><br><span class="line">import axios from &apos;axios&apos;</span><br><span class="line"></span><br><span class="line">export const fetchData = (fn) =&gt; &#123;</span><br><span class="line">  axios.get(&apos;http://api.github.com/users/lonely&apos;)</span><br><span class="line">    .then(data =&gt; &#123;</span><br><span class="line">      fn(data.data)</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">//demo.test.js</span><br><span class="line">import &#123; fetchData &#125; from &apos;./demo.js&apos;</span><br><span class="line"></span><br><span class="line">test(&apos;回调形式的异步代码测试&apos;, (done) =&gt; &#123;</span><br><span class="line">  fetchData((data) =&gt; &#123;</span><br><span class="line">  	expect(data.login).toContain(&quot;lonely&quot;)</span><br><span class="line">  	done()</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p><code>它的关键在于done函数，在没有执行done函数之前，默认该测试用例没有执行完成，这样就保证了该测试用例一定会跑到</code></p>
<h3 id="2-4-2-promise形式的异步代码"><a href="#2-4-2-promise形式的异步代码" class="headerlink" title="2.4.2 promise形式的异步代码"></a>2.4.2 promise形式的异步代码</h3><p><code>如果该异步代码是promise形式的，那采用以下的方法来进行测试</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">// demo.js</span><br><span class="line">import axios from &apos;axios&apos;</span><br><span class="line"></span><br><span class="line">export const fetchData = (fn) =&gt; &#123;</span><br><span class="line">  return axios.get(&apos;http://api.github.com/users/lonely&apos;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">// demo.test.js</span><br><span class="line">import &#123; fetchData &#125; from &apos;./demo.js&apos;</span><br><span class="line"></span><br><span class="line">test(&apos;promise形式的异步代码测试&apos;, () =&gt; &#123;</span><br><span class="line">  return fetchData().then(data =&gt; &#123;</span><br><span class="line">    expect(data.data.login).toContain(&apos;lonely&apos;)</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p><code>这个的关键是想使用普通promise一样需要将他们返回回去</code></p>
<h3 id="2-4-3-async-await形式的异步代码"><a href="#2-4-3-async-await形式的异步代码" class="headerlink" title="2.4.3 async/await形式的异步代码"></a>2.4.3 async/await形式的异步代码</h3><p><code>如果该异步代码是async/await形式的，那采用以下的方法来进行测试</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">// demo.js</span><br><span class="line">import axios from &apos;axios&apos;</span><br><span class="line"></span><br><span class="line">export const fetchData = (fn) =&gt; &#123;</span><br><span class="line">  return axios.get(&apos;http://api.github.com/users/lonely&apos;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">// demo.test.js</span><br><span class="line">import &#123; fetchData &#125; from &apos;./demo.js&apos;</span><br><span class="line"></span><br><span class="line">test(&apos;async/await形式的异步代码测试&apos;, async () =&gt; &#123;</span><br><span class="line">  await expect(fetchData()).resolves.toMatchObject(&#123;</span><br><span class="line">  	data:&#123;</span><br><span class="line">		login: &quot;lonely&quot;,</span><br><span class="line">		id: 211850,</span><br><span class="line">		node_id: &quot;MDQ6VXNlcjIxMTg1MA==&quot;,</span><br><span class="line">		avatar_url: &quot;https://avatars3.githubusercontent.com/u/211850?v=4&quot;,</span><br><span class="line">		gravatar_id: &quot;&quot;,</span><br><span class="line">		url: &quot;https://api.github.com/users/lonely&quot;,</span><br><span class="line">		html_url: &quot;https://github.com/lonely&quot;,</span><br><span class="line">		followers_url: &quot;https://api.github.com/users/lonely/followers&quot;,</span><br><span class="line">		following_url: &quot;https://api.github.com/users/lonely/following&#123;/other_user&#125;&quot;,</span><br><span class="line">		gists_url: &quot;https://api.github.com/users/lonely/gists&#123;/gist_id&#125;&quot;,</span><br><span class="line">		starred_url: &quot;https://api.github.com/users/lonely/starred&#123;/owner&#125;&#123;/repo&#125;&quot;,</span><br><span class="line">		subscriptions_url: &quot;https://api.github.com/users/lonely/subscriptions&quot;,</span><br><span class="line">		organizations_url: &quot;https://api.github.com/users/lonely/orgs&quot;,</span><br><span class="line">		repos_url: &quot;https://api.github.com/users/lonely/repos&quot;,</span><br><span class="line">		events_url: &quot;https://api.github.com/users/lonely/events&#123;/privacy&#125;&quot;,</span><br><span class="line">		received_events_url: &quot;https://api.github.com/users/lonely/received_events&quot;,</span><br><span class="line">		type: &quot;User&quot;,</span><br><span class="line">		site_admin: false,</span><br><span class="line">		name: &quot;Theodore Nielsen&quot;,</span><br><span class="line">		company: &quot;Lonely Lamppost Studios&quot;,</span><br><span class="line">		blog: &quot;www.lonelylamppost.com&quot;,</span><br><span class="line">		location: &quot;Chicago, IL&quot;,</span><br><span class="line">		email: null,</span><br><span class="line">		hireable: null,</span><br><span class="line">		bio: null,</span><br><span class="line">		public_repos: 0,</span><br><span class="line">		public_gists: 0,</span><br><span class="line">		followers: 2,</span><br><span class="line">		following: 0,</span><br><span class="line">		created_at: &quot;2010-02-27T03:16:07Z&quot;,</span><br><span class="line">		updated_at: &quot;2015-04-09T19:49:24Z&quot;</span><br><span class="line">	&#125;</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p><code>至此，三种形式的异步代码全部测试完毕</code></p>
<h3 id="2-5JEST钩子函数"><a href="#2-5JEST钩子函数" class="headerlink" title="2.5JEST钩子函数"></a>2.5JEST钩子函数</h3><p><code>钩子函数，就是指在特定时间里自动触发的函数，在jest中有很多这样的函数，具体意义如下：</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">// demo.test.js</span><br><span class="line">beforeAll(() =&gt; &#123;</span><br><span class="line">  //在所有测试执行前执行的代码，一个周期只执行一次</span><br><span class="line">&#125;)</span><br><span class="line">beforeEach(() =&gt; &#123;</span><br><span class="line">  //在每个测试用例执行前执行的代码，一个周期执行的次数等于测试用例的个数</span><br><span class="line">&#125;)</span><br><span class="line">describe(&quot;A模块相关的测试用例&quot;, () =&gt; &#123;</span><br><span class="line">  it(&quot;A1测试&quot;，() =&gt; &#123;&#125;)</span><br><span class="line">  it(&quot;A2测试&quot;，() =&gt; &#123;&#125;)</span><br><span class="line">&#125;)</span><br><span class="line">test.only(&quot;唯一执行的测试用例&quot;,() =&gt; &#123;&#125;)</span><br></pre></td></tr></table></figure>

<h3 id="2-6JEST的mock"><a href="#2-6JEST的mock" class="headerlink" title="2.6JEST的mock"></a>2.6JEST的mock</h3><p><code>在进行测试，一些复杂函数的执行会浪费比较大的性能，定时器等会消耗大量的时间，axios异步请求会等待一段时间，但实际上这些内容都不是测试的重点，测试的重点是要使得整体的功能在流程上没有问题，所以这些耗时费能的操作都可以通过模拟实现，然后在使用时直接调取模拟好的内容即可，不必真的取执行相关代码，进而提升性能</code></p>
<h3 id="2-6-1捕获函数调用和返回"><a href="#2-6-1捕获函数调用和返回" class="headerlink" title="2.6.1捕获函数调用和返回"></a>2.6.1捕获函数调用和返回</h3><p><code>在一些函数调用中，没有明确的返回，那测试时如何知道它被调用了呢？这就要使用mock，具体如下：</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">// demo.js</span><br><span class="line">export const runCallback = (callback) =&gt; &#123;</span><br><span class="line">  callback(&apos;abc&apos;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">// demo.test.js</span><br><span class="line">import &#123; runCallback &#125; from &apos;./demo.js&apos;</span><br><span class="line"></span><br><span class="line">test(&quot;mock捕获函数调用&quot;,() =&gt; &#123;</span><br><span class="line">  const func = jest.fn()</span><br><span class="line">  func.mockReturnValueOnce(&apos;hello&apos;)  </span><br><span class="line">  runCallback(func)</span><br><span class="line">  expect(func.mock.calls.length).toBe(1)</span><br><span class="line">  expect(func.mock.calls[0]).toEqual([&apos;abc&apos;])</span><br><span class="line">  expect(func.mock.resultss[0].value).toBe([&apos;hello&apos;])</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p><code>它的关键是jest.fn(),它会在调用时在func上拥有mock属性，通过这些属性来进行测试判断的依据</code></p>
<h3 id="2-6-2-模拟函数内部实现"><a href="#2-6-2-模拟函数内部实现" class="headerlink" title="2.6.2 模拟函数内部实现"></a>2.6.2 模拟函数内部实现</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">//demo.js</span><br><span class="line">import axios from &apos;axios&apos;</span><br><span class="line"></span><br><span class="line">export const fetchData = () =&gt; &#123;</span><br><span class="line">  return axios.get(&quot;http://api.github.com/users/lonely&quot;)</span><br><span class="line">    .then(res =&gt; res.data)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">// demo.test.js</span><br><span class="line">import axios from &apos;axios&apos;</span><br><span class="line">jest.mock(&apos;axios&apos;)</span><br><span class="line"></span><br><span class="line">import &#123; fetchData &#125; from &apos;./demo.js&apos;</span><br><span class="line"></span><br><span class="line">test(&quot;mock模拟函数实现测试&quot;,async () =&gt; &#123;</span><br><span class="line">  axios.get.mockResolvedValue(&#123; data: &apos;hello&apos; &#125;)</span><br><span class="line">  await fetchData().then((data) =&gt; &#123;</span><br><span class="line">    expect(data).toBe(&apos;hello&apos;)</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p><code>通过这种方法实现了接口数据获取的重新实现，不用等异步返回数据，只写调用写好的数据即可，除此以外还可以用另外一种方式实现</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mkdir __mocks__</span><br><span class="line">touch demo.js//新建同名文件</span><br></pre></td></tr></table></figure>

<p><code>在同名文件中</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">//同名的demo.js</span><br><span class="line">export const fetchData = () =&gt; &#123;</span><br><span class="line">  return new Promise((resolved,reject) =&gt; &#123;</span><br><span class="line">    resolved(&quot;hello&quot;)</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>在原文件中</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">//原文件demo.js</span><br><span class="line">import axios from &apos;axios&apos;</span><br><span class="line"></span><br><span class="line">export const fetchData = () =&gt; &#123;</span><br><span class="line">  return axios.get(&quot;http://api.github.com/users/lonely&quot;).then(res =&gt; res.data)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>在测试文件中</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">// demo.test.js</span><br><span class="line">jest.mock(&apos;./demo.js&apos;)</span><br><span class="line"></span><br><span class="line">import &#123; fetchData &#125; from &apos;./demo.js&apos;</span><br><span class="line"></span><br><span class="line">test(&quot;mock模拟函数实现测试&quot;, () =&gt; &#123;</span><br><span class="line">  return fetchData().then(data =&gt; &#123;</span><br><span class="line">    expect(data).toEqual(&apos;hello&apos;)</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p><code>此时请求的就不是真实的数据而是我们改写后的函数</code></p>
<h3 id="2-6-3-模拟定时器"><a href="#2-6-3-模拟定时器" class="headerlink" title="2.6.3 模拟定时器"></a>2.6.3 模拟定时器</h3><p><code>在实际的测试中，我们并不会傻傻的等待所有的定时器都跑完，而是采用jest内置的方法直接跳过所有的定时器执行具体的代码，加快测试的进程</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">//demo.js</span><br><span class="line">export default (callback) =&gt; &#123;</span><br><span class="line">  setTimeout(() =&gt; &#123;</span><br><span class="line">    callback()</span><br><span class="line">  &#125;,3000)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">//demo.test.js</span><br><span class="line">import timer from &apos;./demo.js&apos;</span><br><span class="line"></span><br><span class="line">beforeEach(() =&gt; &#123;</span><br><span class="line">	jest.useFakeTimers()</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">test(&quot;mock模拟定时器测试&quot;, () =&gt; &#123;</span><br><span class="line">  const fn = jest.fn()</span><br><span class="line">  timer(fn)</span><br><span class="line">  jest.advanceTimersByTime(3000)</span><br><span class="line">  expect(fn).toHaveBeenCalledTimes(1)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h3 id="2-7-JEST快照"><a href="#2-7-JEST快照" class="headerlink" title="2.7 JEST快照"></a>2.7 JEST快照</h3><p><code>快照就是指对当前代码状态做一次保存，如果代码发生了修改，测试就会因为前后状态不一样而报错，这样就能提醒我们主动的去检查添加的新状态是否有错，没错就更新快照，有错就改错，具体如下：</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">//demo.js</span><br><span class="line">export const generateConfig = () =&gt; &#123;</span><br><span class="line">  return &#123;</span><br><span class="line">    serve: &quot;http://localhost&quot;,</span><br><span class="line">    port: 8080</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">//demo.test.js</span><br><span class="line">import &#123; generateConfig &#125; from &apos;./demo.js&apos;</span><br><span class="line"></span><br><span class="line">test(&quot;快照测试&quot;, () =&gt; &#123;</span><br><span class="line">  expect(generateConfig()).toMatchSnapshot()</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p><code>写好以后，当运行测试命令时，会在根目录下生成一个__snapShots__/demo.test.js.snap的文件保存当前代码的状态，</code><br><img src="http://m.qpic.cn/psb?/V11lyZSe37bh9p/WW1ZyZsm1.Th9NnAz3BVpL5TNaNLCKnVAGKWUmLSYfY!/b/dL4AAAAAAAAA&bo=pQLLAQAAAAADF18!&rf=viewer_4&t=5" alt="ssdfa"></p>
<p><code>然后如果我们修改了原文件内的代码，代表着代码状态发生了改变，就会提醒我们两者不相符</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">//demo.js</span><br><span class="line">export const generateConfig = () =&gt; &#123;</span><br><span class="line">  return &#123;</span><br><span class="line">    serve: &quot;http://localhost&quot;,</span><br><span class="line">    port: 8080,</span><br><span class="line">    host: &quot;demo&quot;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="http://m.qpic.cn/psb?/V11lyZSe37bh9p/ZPQQ6EGoo68GmVqHflVGa*dTiSIwWX*E9OJ.Z4z38LE!/b/dL4AAAAAAAAA&bo=pQLLAQAAAAADF18!&rf=viewer_4&t=5" alt="xx"></p>
<p><code>检查后确定时正确的代码，那就可以先按w再按u更新快照使得代码通过检测</code><br><img src="http://m.qpic.cn/psb?/V11lyZSe37bh9p/f8zzcQARiXIpQVaGPSJT1x0fi.S7auIAZk4iIzUJDy8!/b/dDYBAAAAAAAA&bo=pQLLAQAAAAADF18!&rf=viewer_4&t=5" alt="lsjf"></p>
<h2 id="3-TDD开发Vue项目"><a href="#3-TDD开发Vue项目" class="headerlink" title="3.TDD开发Vue项目"></a>3.TDD开发Vue项目</h2><h3 id="3-1-初始化项目"><a href="#3-1-初始化项目" class="headerlink" title="3.1 初始化项目"></a>3.1 初始化项目</h3><p><code>学过了上面的这些内容，我们可以实践一下，使用TDD结合单元测试来开发一个TODOList的销项目，看看具体的测试流程是怎样的，先来初始化一下项目，我采用的时vue-cli3，具体配置如下：</code><br><img src="http://m.qpic.cn/psb?/V11lyZSe37bh9p/QY7cYbXcyrc.kMgYmDrQNE2M3WZUK7aIr2QFWEy3zHE!/b/dLYAAAAAAAAA&bo=UwJ4AQAAAAADFxo!&rf=viewer_4&t=5" alt="drgd"></p>
<p><code>接着来修改一下文件，去除不必要的内容</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div class=&quot;hello&quot;&gt;</span><br><span class="line">    &lt;h1&gt;&#123;&#123; msg &#125;&#125;&lt;/h1&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">export default &#123;</span><br><span class="line">  name: &apos;HelloWorld&apos;,</span><br><span class="line">  props: &#123;</span><br><span class="line">    msg: String</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style scoped lang=&quot;stylus&quot;&gt;&lt;/style&gt;</span><br></pre></td></tr></table></figure>

<p><code>修改一下测试文件名称和配置</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">//example.spec.js</span><br><span class="line">修改为helloWorld.test.js</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">//jest.config.js</span><br><span class="line">testMatch: [</span><br><span class="line">    &apos;**tests/unit/**/*.(spec|test).(js|jsx|ts|tsx)|**/__tests__/**.(js|jsx|ts|tsx)&apos;</span><br><span class="line">  ],</span><br></pre></td></tr></table></figure>

<p><code>然后运行测试命令即可测试成功</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm run test:unit</span><br></pre></td></tr></table></figure>

<p><code>接着来改造一下目录,将原来的test文件夹删掉</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">- src</span><br><span class="line">  - containers</span><br><span class="line">    - TodoList</span><br><span class="line">	  - __test__</span><br><span class="line">	    - TodoList.test.js</span><br><span class="line">	  - components</span><br><span class="line">	    - header.vue</span><br><span class="line">	  - TodoList.vue</span><br></pre></td></tr></table></figure>

<p><code>在TodoList.test.js中写点测试用例</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">import &#123; shallowMount &#125; from &apos;@vue/test-utils&apos;</span><br><span class="line">import TodoList from &apos;../../TodoList.vue&apos;</span><br><span class="line"></span><br><span class="line">describe(&apos;TodoList.vue&apos;, () =&gt; &#123;</span><br><span class="line">  it(&apos;组件正常渲染&apos;, () =&gt; &#123;</span><br><span class="line">    const wrapper = shallowMount(TodoList)</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p><code>此时测试一下，依然能成功运行，至此项目初始化结束，将代码提交到线上的仓库</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">//package.json</span><br><span class="line">  &quot;repository&quot;: &#123;</span><br><span class="line">    &quot;type&quot;: &quot;git&quot;,</span><br><span class="line">    &quot;url&quot;: &quot;git@github.com:gaoyakang/TODOList.git&quot;</span><br><span class="line">  &#125;,</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">git add .</span><br><span class="line">git commit -m &apos;init finished&apos;</span><br><span class="line">git push -u origin master -f</span><br></pre></td></tr></table></figure>

<h3 id="3-2-编写测试用例"><a href="#3-2-编写测试用例" class="headerlink" title="3.2 编写测试用例"></a>3.2 编写测试用例</h3><h3 id="3-2-1Header组件开发"><a href="#3-2-1Header组件开发" class="headerlink" title="3.2.1Header组件开发"></a>3.2.1Header组件开发</h3><p><code>既然采用的是基于TDD的开发方式，那就需要在写代码前写好测试用例，然后根据测试用例来写具体的代码，首先开发header区域,首先得有个输入框，所以先写测试用例：</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">// header.test.js</span><br><span class="line">import &#123; shallowMount &#125; from &apos;@vue/test-utils&apos;</span><br><span class="line">import Header from &apos;../../Header/components/header.vue&apos;</span><br><span class="line"></span><br><span class="line">describe(&apos;Header.vue&apos;, () =&gt; &#123;</span><br><span class="line">  it(&apos;header 包含 input框&apos;, () =&gt; &#123;</span><br><span class="line">    const wrapper = shallowMount(Header)</span><br><span class="line">    const input = wrapper.find(&apos;[data-test=&quot;input&quot;]&apos;)</span><br><span class="line">    expect(input.exists()).toBe(true)</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p><code>此时运行测试就会出错，应为还没写业务代码，所以此时去写</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">// header.vue</span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    &lt;input data-test=&quot;input&quot;&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">export default &#123;</span><br><span class="line">  name: &apos;Header&apos;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style scoped lang=&quot;stylus&quot;&gt;&lt;/style&gt;</span><br></pre></td></tr></table></figure>

<p><code>此时再去运行测试就会通过，这就是TDD开发模式，并且这种测试还叫单元测试，因为只是对单一模块进行了测试，其他模块的开发也是按照这种方式来进行，下面就不加以说明了，直接写</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">it(&apos;header 中 input 框初始内容为空&apos;, () =&gt; &#123;</span><br><span class="line">   const wrapper = shallowMount(Header)</span><br><span class="line">   const inputValue = wrapper.vm.$data.inputValue</span><br><span class="line">   expect(inputValue).toBe(&apos;&apos;)</span><br><span class="line"> &#125;)</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    &lt;input data-test=&quot;input&quot; :value=&quot;inputValue&quot;&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">export default &#123;</span><br><span class="line">  name: &apos;Header&apos;,</span><br><span class="line">  data () &#123;</span><br><span class="line">    return &#123;</span><br><span class="line">      inputValue: &apos;&apos;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style scoped lang=&quot;stylus&quot;&gt;&lt;/style&gt;</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">it(&apos;header 中 input 框输入值发生改变，数据也跟着变&apos;, () =&gt; &#123;</span><br><span class="line">    const wrapper = shallowMount(Header)</span><br><span class="line">    const input = wrapper.find(&apos;[data-test=&quot;input&quot;]&apos;)</span><br><span class="line">    input.setValue(&quot;JEST&quot;)</span><br><span class="line">    const inputValue = wrapper.vm.$data.inputValue</span><br><span class="line">    expect(inputValue).toBe(&apos;JEST&apos;)</span><br><span class="line">  &#125;)</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    &lt;input data-test=&quot;input&quot; v-model=&quot;inputValue&quot;&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">export default &#123;</span><br><span class="line">  name: &apos;Header&apos;,</span><br><span class="line">  data () &#123;</span><br><span class="line">    return &#123;</span><br><span class="line">      inputValue: &apos;&apos;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style scoped lang=&quot;stylus&quot;&gt;&lt;/style&gt;</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">it(&apos;header 中 input 框输入回车，无内容无反应&apos;, () =&gt; &#123;</span><br><span class="line">    const wrapper = shallowMount(Header)</span><br><span class="line">    const input = wrapper.find(&apos;[data-test=&quot;input&quot;]&apos;)</span><br><span class="line">    input.setValue(&quot;&quot;)</span><br><span class="line">    input.trigger(&apos;keyup.enter&apos;)</span><br><span class="line">    expect(wrapper.emitted.add).toBeFalsy()</span><br><span class="line">  &#125;)</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    &lt;input</span><br><span class="line">      data-test=&quot;input&quot;</span><br><span class="line">      v-model=&quot;inputValue&quot;</span><br><span class="line">	  @keyup.enter=&quot;addTodoItem&quot;</span><br><span class="line">    /&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">export default &#123;</span><br><span class="line">  name: &apos;Header&apos;,</span><br><span class="line">  data () &#123;</span><br><span class="line">    return &#123;</span><br><span class="line">      inputValue: &apos;&apos;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  methods: &#123;</span><br><span class="line">    addTodoItem () &#123;</span><br><span class="line">      if (this.inputValue) &#123;</span><br><span class="line">        this.$emit(&apos;add&apos;, this.inputValue)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style scoped lang=&quot;stylus&quot;&gt;&lt;/style&gt;</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">it(&apos;header 中 input 框输入回车，有内容向外触发事件,清空inputValue&apos;, () =&gt; &#123;</span><br><span class="line">    const wrapper = shallowMount(Header)</span><br><span class="line">    const input = wrapper.find(&apos;[data-test=&quot;input&quot;]&apos;)</span><br><span class="line">    input.setValue(&quot;JEST&quot;)</span><br><span class="line">    input.trigger(&apos;keyup.enter&apos;)</span><br><span class="line">    expect(wrapper.emitted().add).toBeTruthy()</span><br><span class="line">    expect(wrapper.vm.$data.inputValue).toBe(&apos;&apos;)</span><br><span class="line">  &#125;)</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    &lt;input</span><br><span class="line">      data-test=&quot;input&quot;</span><br><span class="line">      v-model=&quot;inputValue&quot;</span><br><span class="line">	  @keyup.enter=&quot;addTodoItem&quot;</span><br><span class="line">    /&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">export default &#123;</span><br><span class="line">  name: &apos;Header&apos;,</span><br><span class="line">  data () &#123;</span><br><span class="line">    return &#123;</span><br><span class="line">      inputValue: &apos;&apos;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  methods: &#123;</span><br><span class="line">    addTodoItem () &#123;</span><br><span class="line">      if (this.inputValue) &#123;</span><br><span class="line">        this.$emit(&apos;add&apos;, this.inputValue)</span><br><span class="line">        this.inputValue =&apos;&apos;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style scoped lang=&quot;stylus&quot;&gt;&lt;/style&gt;</span><br></pre></td></tr></table></figure>

<h3 id="3-2-2-todolist组件开发"><a href="#3-2-2-todolist组件开发" class="headerlink" title="3.2.2 todolist组件开发"></a>3.2.2 todolist组件开发</h3><p><code>接着开发todolist组件</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">import &#123; shallowMount &#125; from &apos;@vue/test-utils&apos;</span><br><span class="line">import TodoList from &apos;../../TodoList.vue&apos;</span><br><span class="line"></span><br><span class="line">describe(&apos;TodoList测试&apos;, () =&gt; &#123;</span><br><span class="line">  it(&apos;todoItem 初始化时，ubdoList应该为空&apos;, () =&gt; &#123;</span><br><span class="line">    const wrapper = shallowMount(TodoList)</span><br><span class="line">    const undoList = wrapper.vm.$data.undoList</span><br><span class="line">    expect(undoList).toEqual([])</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">	&lt;Header /&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">import Header from &apos;./components/header.vue&apos;</span><br><span class="line">export default &#123;</span><br><span class="line">  name: &apos;TodoList&apos;,</span><br><span class="line">  components: &#123;</span><br><span class="line">    Header</span><br><span class="line">  &#125;,</span><br><span class="line">  data () &#123;</span><br><span class="line">    return &#123;</span><br><span class="line">      undoList: []</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style scoped lang=&quot;stylus&quot;&gt;&lt;/style&gt;</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">it(&apos;TodoList 监听到 header 的 add事件的时候，会增加一个内容&apos;, () =&gt; &#123;</span><br><span class="line">    const wrapper = shallowMount(TodoList)</span><br><span class="line">    const header = wrapper.find(Header)</span><br><span class="line">    Header.vm.$emit(&apos;add&apos;,&quot;JEST&quot;)</span><br><span class="line">    const undoList = wrapper.vm.$data.undoList</span><br><span class="line">    expect(undoList).toEqual([&apos;JEST&apos;])</span><br><span class="line">  &#125;)</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">	&lt;Header @add=&quot;addUndoItem&quot;/&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">import Header from &apos;./components/header.vue&apos;</span><br><span class="line">export default &#123;</span><br><span class="line">  name: &apos;TodoList&apos;,</span><br><span class="line">  components: &#123;</span><br><span class="line">    Header</span><br><span class="line">  &#125;,</span><br><span class="line">  data () &#123;</span><br><span class="line">    return &#123;</span><br><span class="line">      undoList: []</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  methods: &#123;</span><br><span class="line">    addUndoItem (inputValue) &#123;</span><br><span class="line">      this.undoList.push(inputValue)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style scoped lang=&quot;stylus&quot;&gt;&lt;/style&gt;</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">it(&apos;header样式发生改变时给出提示&apos;, () =&gt; &#123;</span><br><span class="line">    const wrapper = shallowMount(Header)</span><br><span class="line">    expect(wrapper).toMatchSnapshot()</span><br><span class="line">  &#125;)</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div class=&quot;header&quot;&gt;</span><br><span class="line">  &lt;div class=&quot;header-content&quot;&gt;</span><br><span class="line">    TODOLIST</span><br><span class="line">    &lt;input</span><br><span class="line">      data-test=&quot;input&quot;</span><br><span class="line">      v-model=&quot;inputValue&quot;</span><br><span class="line">      @keyup.enter=&quot;addTodoItem&quot;</span><br><span class="line">      class=&quot;header-input&quot;</span><br><span class="line">      placeholder=&quot;您要干点嘛啊-~~~&quot;</span><br><span class="line">    /&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">export default &#123;</span><br><span class="line">  name: &apos;Header&apos;,</span><br><span class="line">  data () &#123;</span><br><span class="line">    return &#123;</span><br><span class="line">      inputValue: &apos;&apos;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  methods: &#123;</span><br><span class="line">    addTodoItem (inputValue) &#123;</span><br><span class="line">      if (this.inputValue) &#123;</span><br><span class="line">        this.$emit(&apos;add&apos;, this.inputValue)</span><br><span class="line">        this.inputValue =&apos;&apos;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style scoped lang=&quot;stylus&quot;&gt;</span><br><span class="line">  .header &#123;</span><br><span class="line">    line-height: 60px;</span><br><span class="line">    background: #333;</span><br><span class="line">  &#125;</span><br><span class="line">  .header-content &#123;</span><br><span class="line">    width: 600px;</span><br><span class="line">    margin: 0 auto;</span><br><span class="line">    color: #fff;</span><br><span class="line">    font-size: 24px;;</span><br><span class="line">  &#125;</span><br><span class="line">  .header-input &#123;</span><br><span class="line">    float: right;</span><br><span class="line">    width: 360px;</span><br><span class="line">    margin-top: 16px</span><br><span class="line">    line-height: 24px;</span><br><span class="line">    outline: none;</span><br><span class="line">    color: #333;</span><br><span class="line">    text-indent: 10px;</span><br><span class="line">  &#125;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure>

<h3 id="3-2-3-UndoList组件开发"><a href="#3-2-3-UndoList组件开发" class="headerlink" title="3.2.3 UndoList组件开发"></a>3.2.3 UndoList组件开发</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">import &#123; shallowMount &#125; from &apos;@vue/test-utils&apos;</span><br><span class="line">import UndoList from &apos;../../components/undoList.vue&apos;</span><br><span class="line">import &#123; findTestWrapper &#125; from &apos;../../../../utils/testUtils&apos;</span><br><span class="line"></span><br><span class="line">describe(&apos;undoList.vue&apos;, () =&gt; &#123;</span><br><span class="line">  it(&apos;undoList 参数为[], count值为0，且列表无内容&apos;, () =&gt; &#123;</span><br><span class="line">    const wrapper = shallowMount(UndoList, &#123;</span><br><span class="line">      propsData: &#123;</span><br><span class="line">        list: []</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">    const countElem = findTestWrapper(wrapper, &apos;count&apos;)</span><br><span class="line">    const listItems = findTestWrapper(wrapper, &apos;item&apos;)</span><br><span class="line">    expect(countElem.at(0).text()).toEqual(&apos;0&apos;)</span><br><span class="line">    expect(listItems.length).toEqual(0)</span><br><span class="line">  &#125;)</span><br><span class="line"></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    &lt;div data-test=&quot;count&quot;&gt;&#123;&#123;list.length&#125;&#125;&lt;/div&gt;</span><br><span class="line">    &lt;ul&gt;</span><br><span class="line">      &lt;li</span><br><span class="line">        v-for=&quot;(item,index) in list&quot;</span><br><span class="line">        :key=&quot;index&quot;</span><br><span class="line">        data-test=&quot;item&quot;</span><br><span class="line">      &gt;</span><br><span class="line">        &#123;&#123;item&#125;&#125;</span><br><span class="line">      &lt;/li&gt;</span><br><span class="line">    &lt;/ul&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">export default &#123;</span><br><span class="line">  name: &apos;UndoList&apos;,</span><br><span class="line">  props: [&apos;list&apos;]</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style scoped lang=&quot;stylus&quot;&gt;&lt;/style&gt;</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">it(&apos;undoList 参数为[1,2,3], count值为3，且列表有内容，且存在删除按钮&apos;, () =&gt; &#123;</span><br><span class="line">      const wrapper = shallowMount(UndoList, &#123;</span><br><span class="line">        propsData: &#123;</span><br><span class="line">          list: [1,2,3]</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;)</span><br><span class="line">      const countElem = findTestWrapper(wrapper, &apos;count&apos;)</span><br><span class="line">      const listItems = findTestWrapper(wrapper, &apos;item&apos;)</span><br><span class="line">      const deleteButtons = findTestWrapper(wrapper, &apos;delete-button&apos;)</span><br><span class="line">      expect(countElem.at(0).text()).toEqual(&apos;3&apos;)</span><br><span class="line">      expect(listItems.length).toEqual(3)</span><br><span class="line">      expect(deleteButtons.length).toEqual(3)</span><br><span class="line">    &#125;)</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    &lt;div data-test=&quot;count&quot;&gt;&#123;&#123;list.length&#125;&#125;&lt;/div&gt;</span><br><span class="line">    &lt;ul&gt;</span><br><span class="line">      &lt;li</span><br><span class="line">        v-for=&quot;(item,index) in list&quot;</span><br><span class="line">        :key=&quot;index&quot;</span><br><span class="line">        data-test=&quot;item&quot;</span><br><span class="line">      &gt;</span><br><span class="line">        &#123;&#123;item&#125;&#125;</span><br><span class="line">        &lt;span</span><br><span class="line">          data-test=&quot;delete-button&quot;</span><br><span class="line">          @click=&quot;() =&gt; &#123; handleDelete(index) &#125;&quot;</span><br><span class="line">        &gt;-&lt;/span&gt;</span><br><span class="line">      &lt;/li&gt;</span><br><span class="line">    &lt;/ul&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">export default &#123;</span><br><span class="line">  name: &apos;UndoList&apos;,</span><br><span class="line">  props: [&apos;list&apos;],</span><br><span class="line">  methods: &#123;</span><br><span class="line">    handleDelete (index) &#123;</span><br><span class="line">      this.$emit(&apos;delete&apos;,index)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style scoped lang=&quot;stylus&quot;&gt;&lt;/style&gt;</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">it(&apos;undoList 删除按钮被点击时，向外触发删除事件&apos;, () =&gt; &#123;</span><br><span class="line">      const wrapper = shallowMount(UndoList, &#123;</span><br><span class="line">        propsData: &#123;</span><br><span class="line">          list: [1,2,3]</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;)</span><br><span class="line">      const deleteButtons = findTestWrapper(wrapper, &apos;delete-button&apos;).at(1)</span><br><span class="line">      deleteButtons.trigger(&apos;click&apos;)</span><br><span class="line">      expect(wrapper.emitted().delete).toBeTruthy()</span><br><span class="line">    &#125;)</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    &lt;div data-test=&quot;count&quot;&gt;&#123;&#123;list.length&#125;&#125;&lt;/div&gt;</span><br><span class="line">    &lt;ul&gt;</span><br><span class="line">      &lt;li</span><br><span class="line">        v-for=&quot;(item,index) in list&quot;</span><br><span class="line">        :key=&quot;index&quot;</span><br><span class="line">        data-test=&quot;item&quot;</span><br><span class="line">      &gt;</span><br><span class="line">        &#123;&#123;item&#125;&#125;</span><br><span class="line">        &lt;span</span><br><span class="line">          data-test=&quot;delete-button&quot;</span><br><span class="line">          @click=&quot;() =&gt; &#123; handleDelete(index) &#125;&quot;</span><br><span class="line">        &gt;-&lt;/span&gt;</span><br><span class="line">      &lt;/li&gt;</span><br><span class="line">    &lt;/ul&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">export default &#123;</span><br><span class="line">  name: &apos;UndoList&apos;,</span><br><span class="line">  props: [&apos;list&apos;],</span><br><span class="line">  methods: &#123;</span><br><span class="line">    handleDelete (index) &#123;</span><br><span class="line">      this.$emit(&apos;delete&apos;,index)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style scoped lang=&quot;stylus&quot;&gt;&lt;/style&gt;</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">it(&apos;TodoList 调用 undoList 应该传递list 参数&apos;, () =&gt; &#123;</span><br><span class="line">    const wrapper = shallowMount(TodoList)</span><br><span class="line">    const undoList = wrapper.find(UndoList)</span><br><span class="line">    const list = undoList.props(&apos;list&apos;)</span><br><span class="line">    expect(list).toBeTruthy()</span><br><span class="line">  &#125;)</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">	&lt;Header @add=&quot;addUndoItem&quot; /&gt;</span><br><span class="line">  &lt;undoList :list=&quot;undoList&quot; /&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">import Header from &apos;./components/header.vue&apos;</span><br><span class="line">import undoList from &apos;./components/undoList.vue&apos;</span><br><span class="line"></span><br><span class="line">export default &#123;</span><br><span class="line">  name: &apos;TodoList&apos;,</span><br><span class="line">  components: &#123;</span><br><span class="line">    Header,</span><br><span class="line">    undoList</span><br><span class="line">  &#125;,</span><br><span class="line">  data () &#123;</span><br><span class="line">    return &#123;</span><br><span class="line">      undoList: []</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  methods: &#123;</span><br><span class="line">    addUndoItem (inputValue) &#123;</span><br><span class="line">      this.undoList.push(inputValue)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style scoped lang=&quot;stylus&quot;&gt;&lt;/style&gt;</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">it(&apos;TodoList中handleItemDelete方法被调用时，undolist列表内容会减1&apos;, () =&gt; &#123;</span><br><span class="line">    const wrapper = shallowMount(TodoList)</span><br><span class="line">    wrapper.setData(&#123;</span><br><span class="line">      undoList: [1,2,3]</span><br><span class="line">    &#125;)</span><br><span class="line">    wrapper.vm.handleItemDelete(1)</span><br><span class="line">    expect(wrapper.vm.$data.undoList).toEqual([1,3])</span><br><span class="line">  &#125;)</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">	  &lt;Header @add=&quot;addUndoItem&quot; /&gt;</span><br><span class="line">    &lt;undoList :list=&quot;undoList&quot; @delete=&quot;handleItemDelete&quot; /&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">import Header from &apos;./components/header.vue&apos;</span><br><span class="line">import undoList from &apos;./components/undoList.vue&apos;</span><br><span class="line"></span><br><span class="line">export default &#123;</span><br><span class="line">  name: &apos;TodoList&apos;,</span><br><span class="line">  components: &#123;</span><br><span class="line">    Header,</span><br><span class="line">    undoList</span><br><span class="line">  &#125;,</span><br><span class="line">  data () &#123;</span><br><span class="line">    return &#123;</span><br><span class="line">      undoList: []</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  methods: &#123;</span><br><span class="line">    addUndoItem (inputValue) &#123;</span><br><span class="line">      this.undoList.push(inputValue)</span><br><span class="line">    &#125;,</span><br><span class="line">    handleItemDelete (index) &#123;</span><br><span class="line">      this.undoList.splice(index,1)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style scoped lang=&quot;stylus&quot;&gt;&lt;/style&gt;</span><br></pre></td></tr></table></figure>

<p><code>最后把覆盖率报告生成一下</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">// jest.config.js</span><br><span class="line">  collectCoverageFrom: [&quot;**/*.&#123;js,vue&#125;&quot;,&quot;**/node_modules/**&quot;],</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&quot;scripts&quot;: &#123;</span><br><span class="line">  &quot;test:cov&quot;: &quot;vue-cli-service test:unit --coverage&quot;</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm run test:cov</span><br></pre></td></tr></table></figure>

<p><img src="http://m.qpic.cn/psb?/V11lyZSe37bh9p/5S7SH0YLC.lV4mH0wknDPHSx9hHUb0J*dTjdE6hfMNs!/b/dLYAAAAAAAAA&bo=cQKpAgAAAAADF.o!&rf=viewer_4&t=5" alt="cov"></p>
<h2 id="4-BDD开发TodoList"><a href="#4-BDD开发TodoList" class="headerlink" title="4.BDD开发TodoList"></a>4.BDD开发TodoList</h2><p><code>前面我们使用TDD的开发方式已经开发完了项目，此时就可使用BDD来进行测试，它通常是和集成测试联系在一起的，因为此时所有的模块都开发完成了，可以多个模块结合在一起测试，所以BDD方式适合测试业务类型的代码</code></p>
<h3 id="4-1-BDD测试"><a href="#4-1-BDD测试" class="headerlink" title="4.1 BDD测试"></a>4.1 BDD测试</h3><p><code>在vue的项目中经常会使用到vuex来进行状态管理，所以对vuex代码的测试也是一个重点接下来就演示一下如何测试VUEX代码</code><br><code>首先新建vuex的store，进行一系列的初始化工作</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">//src/store.js</span><br><span class="line">import Vue from &apos;vue&apos;</span><br><span class="line">import Vuex from &apos;vuex&apos;</span><br><span class="line">Vue.use(Vuex)</span><br><span class="line"></span><br><span class="line">const store = new Vuex.Store(&#123;</span><br><span class="line">	state:&#123;</span><br><span class="line">	  inputValue: &apos;&apos;</span><br><span class="line">	&#125;,</span><br><span class="line">	mutations:&#123;</span><br><span class="line">	  changeInputValue (state, payload) &#123;</span><br><span class="line">	  	state.inputValue = payload</span><br><span class="line">	  &#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">export default  store;</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">//header.vue</span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div class=&quot;header&quot;&gt;</span><br><span class="line">    &lt;div class=&quot;header-content&quot;&gt;</span><br><span class="line">      TODOLIST</span><br><span class="line">      &lt;input</span><br><span class="line">        data-test=&quot;input&quot;</span><br><span class="line">        :value=&quot;inputValue&quot;</span><br><span class="line">        @input=&quot;e =&gt; changeInputValue(e.target.value)&quot;</span><br><span class="line">        @keyup.enter=&quot;addTodoItem&quot;</span><br><span class="line">        class=&quot;header-input&quot;</span><br><span class="line">        placeholder=&quot;您要干点嘛啊-~~~&quot;</span><br><span class="line">      /&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line">import &#123; </span><br><span class="line">  mapState,</span><br><span class="line">  mapMutations</span><br><span class="line">&#125; from /vuex</span><br><span class="line">export default &#123;</span><br><span class="line">  computed: &#123;</span><br><span class="line">    ...mapState(&#123;</span><br><span class="line">      inputValue: state =&gt; state.inputValue</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;,</span><br><span class="line">methods: &#123;</span><br><span class="line">  ...mapMutations(&#123;</span><br><span class="line">      changeInputValue: &apos;changeInputValue&apos;</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<div style="text-align:center;margin:30px;font-size:20px;border-radius:5px;border:3px solid #eee; cursor:pointer;" onclick="javascript:window.scrollTo(0, 0)">TOP</div>
            <!--[if lt IE 9]><script>document.createElement('audio');</script><![endif]-->
            <audio id="audio" loop="1" preload="auto" controls="controls" data-autoplay="false">
                <source type="audio/mpeg" src="">
            </audio>
            
                <ul id="audio-list" style="display:none">
                    
                        
                            <li title='0' data-url='http://link.hhtjim.com/163/5146554.mp3'></li>
                        
                    
                        
                            <li title='1' data-url='http://link.hhtjim.com/qq/001faIUs4M2zna.mp3'></li>
                        
                    
                </ul>
            
        </div>
        
    </div>
    
</div>


    </div>
</div>
</body>
<script src="//cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.js"></script>
<script src="//lib.baomitu.com/jquery/1.8.3/jquery.min.js"></script>
<script src="/js/plugin.js"></script>
<script src="/js/diaspora.js"></script>
<link rel="stylesheet" href="/photoswipe/photoswipe.css">
<link rel="stylesheet" href="/photoswipe/default-skin/default-skin.css">
<script src="/photoswipe/photoswipe.min.js"></script>
<script src="/photoswipe/photoswipe-ui-default.min.js"></script>

<!-- Root element of PhotoSwipe. Must have class pswp. -->
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">
    <!-- Background of PhotoSwipe. 
         It's a separate element as animating opacity is faster than rgba(). -->
    <div class="pswp__bg"></div>
    <!-- Slides wrapper with overflow:hidden. -->
    <div class="pswp__scroll-wrap">
        <!-- Container that holds slides. 
            PhotoSwipe keeps only 3 of them in the DOM to save memory.
            Don't modify these 3 pswp__item elements, data is added later on. -->
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>
        <!-- Default (PhotoSwipeUI_Default) interface on top of sliding area. Can be changed. -->
        <div class="pswp__ui pswp__ui--hidden">
            <div class="pswp__top-bar">
                <!--  Controls are self-explanatory. Order can be changed. -->
                <div class="pswp__counter"></div>
                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
                <button class="pswp__button pswp__button--share" title="Share"></button>
                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>
                <!-- Preloader demo http://codepen.io/dimsemenov/pen/yyBWoR -->
                <!-- element will get class pswp__preloader--active when preloader is running -->
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                      <div class="pswp__preloader__cut">
                        <div class="pswp__preloader__donut"></div>
                      </div>
                    </div>
                </div>
            </div>
            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div> 
            </div>
            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>
            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>
            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>
        </div>
    </div>
</div>




</html>
